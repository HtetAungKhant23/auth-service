generator client {
  provider = "prisma-client-js"
}

datasource db {
  // provider = "postgresql"
  provider = "cockroachdb"
  url      = env("DATABASE_URL")
}

model User {
  id        String  @id @default(uuid())
  phone     String?
  email     String  @unique
  password  String?
  isDeleted Boolean @default(false)

  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  userProfile UserProfile?
}

model Otp {
  id     String     @id @default(uuid())
  phone  String     @unique
  code   String
  status OTP_STATUS @default(UNUSED)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model UserProfile {
  id       String    @id @default(uuid())
  username String?
  userId   String    @unique
  user     User      @relation(references: [id], fields: [userId], onDelete: Cascade)
  role     User_Role @default(User)
  fileId   String?
  file     File?     @relation(references: [id], fields: [fileId], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model File {
  id       String @id @default(uuid())
  fileName String
  path     String
  slug     String

  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  UserProfile UserProfile[]
}

enum User_Role {
  SuperAdmin
  Admin
  Staff
  User
}

enum OTP_STATUS {
  UNUSED
  USED
}
